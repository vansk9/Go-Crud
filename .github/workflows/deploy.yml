# name: Docker Auto-Deploy

# on:
#   push:
#     branches: [ main ]

# jobs:
#   deploy:
#     runs-on: ubuntu-latest

#     steps:
#       - name: Checkout Code
#         uses: actions/checkout@v4

#       - name: Deploy via SSH
#         uses: appleboy/ssh-action@master
#         with:
#           host: ${{ secrets.SERVER_IP }}
#           username: ${{ secrets.SERVER_USERNAME }}
#           key: ${{ secrets.SSH_PRIVATE_KEY }}
#           port: ${{ secrets.SERVER_PORT }} # opsional jika bukan 22
#           script: |
#             cd ${{ secrets.DEPLOY_PATH }}

#             # Reset & pull source
#             git fetch --all
#             git reset --hard origin/main
#             git pull origin main

#             # Build & deploy dengan Docker
#             docker build -t go-crud .

#             docker stop go-crud || true
#             docker rm go-crud || true

#             docker run -d \
#               --name go-crud \
#               -p 8080:8080 \
#               --restart unless-stopped \
#               go-crud


name: Deploy to Railway

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Deploy to Railway
        uses: railwayapp/railway-action@v2
        with:
          command: up
        env:
          RAILWAY_TOKEN: ${{ secrets.RAILWAY_TOKEN }}
